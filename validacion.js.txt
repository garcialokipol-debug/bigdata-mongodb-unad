// validacion.js
// Script de validaci√≥n para la colecci√≥n "productos" en la BD "tienda_online"

// Seleccionar la base de datos
use tienda_online;

// 1) Conteo total de documentos
print("üìä Total de documentos en la colecci√≥n:");
print(db.productos.countDocuments());

// 2) Mostrar algunos documentos de prueba
print("üìÑ Ejemplo de 3 documentos de la colecci√≥n:");
printjson(db.productos.find().limit(3).toArray());

// 3) Consultar productos de la categor√≠a Gaming
print("üéÆ Productos en la categor√≠a Gaming:");
printjson(db.productos.find({ categoria: "Gaming" }).limit(5).toArray());

// 4) Promedio de precios por categor√≠a
print("üí∞ Promedio de precios por categor√≠a:");
db.productos.aggregate([
  { $group: { _id: "$categoria", promedioPrecio: { $avg: "$precio" } } },
  { $sort: { promedioPrecio: -1 } }
]).forEach(printjson);

// 5) Conteo de productos por categor√≠a
print("üì¶ Conteo de productos por categor√≠a:");
db.productos.aggregate([
  { $group: { _id: "$categoria", totalProductos: { $sum: 1 } } },
  { $sort: { totalProductos: -1 } }
]).forEach(printjson);

// 6) Top 5 productos con mejor rating
print("‚≠ê Top 5 productos mejor calificados:");
db.productos.aggregate([
  { $sort: { rating: -1, precio: -1 } },
  { $limit: 5 },
  { $project: { nombre: 1, categoria: 1, precio: 1, rating: 1 } }
]).forEach(printjson);

// 7) Stock total por categor√≠a
print("üì¶ Stock total por categor√≠a:");
db.productos.aggregate([
  { $group: { _id: "$categoria", stockTotal: { $sum: "$stock" } } },
  { $sort: { stockTotal: -1 } }
]).forEach(printjson);